container_name: fado_server
image: fedml-client
build: ./docker/client
volumes:
  - '~/.fado/certs/:/app/certs/'
  - '~/.fado/config/:/app/config/'
  - '~/.fado/attack/:/app/attack/:rw'
  - '~/.fado/defense/:/app/defense/:rw'
  #- '~/.fado/data/all:/app/data'
  - '~/.fado/runs/:/app/runs:rw'
  - '~/.fado/logs/:/app/logs:rw'
cap_add:
  - NET_ADMIN # Authorize container to change network configurations
command: >-
  sh -c "/app/configure_ip.sh && /app/run_server.sh"
deploy:
  placement:
    constraints:
      - node.role == manager
networks:
  server_network:
depends_on:
  - "router"