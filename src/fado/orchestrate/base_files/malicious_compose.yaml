container_name: fado_mal-client # For each client it will be container_name + client_rank
image: fedml-client
build: ./docker/client
volumes:
  - '~/.fado/certs/:/app/certs/'
  - '~/.fado/config/:/app/config/'
  - '~/.fado/attack/:/app/attack/:rw'
  - '~/.fado/defense/:/app/defense/:rw'
  - '~/.fado/logs/:/app/logs:rw'
  # - '~/.fado/data:/app/data' Data will be different for each client
environment:
  # - FEDML_RANK=<set after hand> Each client will have a unique rank
  - WAIT_HOSTS=fado_router:8890
  - WAIT_HOST_CONNECT_TIMEOUT=360
  - WAIT_SLEEP_INTERVAL=5
  - WAIT_LOGGER_LEVEL=error
restart: on-failure
cap_add:
  - NET_ADMIN # Authorize container to change network configurations
command: >-
  sh -c "/app/configure_ip.sh && /wait && /app/run_malicious_client.sh"
networks:
  clients_network:
depends_on:
  - "server"